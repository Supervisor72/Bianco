<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Report Punto Vendita</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      background-color: #f4f4f4;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    form {
      background: white;
      padding: 20px;
      border-radius: 10px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 20px;
      padding: 10px;
      background-color: #0057b8;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background-color: #004a9f;
    }
    .section {
      margin-top: 20px;
      padding: 10px;
      background-color: #e9f1f7;
      border-radius: 8px;
    }
  </style>
</head>
<body>

  <h1>Report Punto Vendita</h1>

  <form id="reportForm" action="javascript:void(0);">
    <label for="puntoVendita">Seleziona Punto Vendita:</label>
    <select id="puntoVendita" name="Punto Vendita" required onchange="aggiornaMail()">
      <option value="">-- Seleziona --</option>
      <option value="FANO">FANO</option>
      <option value="MONSANO">MONSANO</option>
      <option value="OSIMO">OSIMO</option>
      <option value="MACERATA">MACERATA</option>
      <option value="CIVITANOVA">CIVITANOVA</option>
      <option value="PESARO">PESARO</option>
    </select>

    <label for="repartoBianco">REPARTO BIANCO:</label>
    <input type="text" id="repartoBianco" name="REPARTO BIANCO" readonly>

    <!-- Sezione Reparto Bianco -->
    <div class="section">
      <h3>Reparto Bianco</h3>
      <label for="biancoDeltaMeseFatt">BIANCO DELTA MESE FATT (€):</label>
      <input type="number" id="biancoDeltaMeseFatt" name="BIANCO DELTA MESE FATT" step="0.01">

      <label for="biancoDeltaMesePrMedio">DELTA MESE PR. MEDIO (€):</label>
      <input type="number" id="biancoDeltaMesePrMedio" name="DELTA MESE PR. MEDIO" step="0.01">
    </div>

    <!-- Sezione Clima -->
    <div class="section">
      <h3>Clima</h3>
      <label for="climaDeltaMeseFatt">CLIMA DELTA MESE FATT (€):</label>
      <input type="number" id="climaDeltaMeseFatt" name="CLIMA DELTA MESE FATT" step="0.01">
    </div>

    <!-- Sezione Focus -->
    <div class="section">
      <h3>Focus</h3>
      <label for="focusAegBianco">AEG BIANCO:</label>
      <input type="number" id="focusAegBianco" name="AEG BIANCO" step="0.01">

      <label for="focusFuoriGriglia">FUORI GRIGLIA:</label>
      <input type="number" id="focusFuoriGriglia" name="FUORI GRIGLIA" step="0.01">

      <label for="focusEkos">EKOS:</label>
      <input type="number" id="focusEkos" name="EKOS" step="0.01">

      <label for="focusSchuko">SCHUKO:</label>
      <input type="number" id="focusSchuko" name="SCHUKO" step="0.01">

      <label for="focusAnticalcare">ANTICALCARE:</label>
      <input type="number" id="focusAnticalcare" name="ANTICALCARE" step="0.01">

      <label for="focusKitGiunzione">KIT GIUNZIONE:</label>
      <input type="number" id="focusKitGiunzione" name="KIT GIUNZIONE" step="0.01">
    </div>

    <button type="button" onclick="inviaEmail()">Invia Report</button>
  </form>

  <script>
    function aggiornaMail() {
      const selezione = document.getElementById("puntoVendita").value;
      const reparto = document.getElementById("repartoBianco");

      reparto.value = selezione;

      // Crea l'oggetto mailto con tutte le informazioni necessarie
      let mailto = "mailto:d.pavoni@dml-italia.com?subject=Report%20Punto%20Vendita%20" + selezione;
      mailto += "&body=REPARTO%20BIANCO%3A%20" + selezione + "%0A%0A";
      mailto += "BIANCO%20DELTA%20MESE%20FATT%3A%20" + document.getElementById("biancoDeltaMeseFatt").value + "%0A";
      mailto += "DELTA%20MESE%20PR.%20MEDIO%3A%20" + document.getElementById("biancoDeltaMesePrMedio").value + "%0A%0A";
      mailto += "CLIMA%20DELTA%20MESE%20FATT%3A%20" + document.getElementById("climaDeltaMeseFatt").value + "%0A%0A";
      mailto += "AEG%20BIANCO%3A%20" + document.getElementById("focusAegBianco").value + "%0A";
      mailto += "FUORI%20GRIGLIA%3A%20" + document.getElementById("focusFuoriGriglia").value + "%0A";
      mailto += "EKOS%3A%20" + document.getElementById("focusEkos").value + "%0A";
      mailto += "SCHUKO%3A%20" + document.getElementById("focusSchuko").value + "%0A";
      mailto += "ANTICALCARE%3A%20" + document.getElementById("focusAnticalcare").value + "%0A";
      mailto += "KIT%20GIUNZIONE%3A%20" + document.getElementById("focusKitGiunzione").value + "%0A%0A";

      // Aggiungi la mail del negozio selezionato come destinatario in CC
      const emailMap = {
        FANO: "trony.fano@dml-italia.com",
        MONSANO: "trony.monsano@dml-italia.com",
        OSIMO: "trony.osimo@dml-italia.com",
        MACERATA: "trony.macerata@dml-italia.com",
        CIVITANOVA: "trony.civitanova@dml-italia.com",
        PESARO: "trony.pesaro@dml-italia.com"
      };

      mailto += "&cc=" + emailMap[selezione];

      // Imposta il link mailto come destinazione del bottone
      document.getElementById("reportForm").action = mailto;
    }

    function inviaEmail() {
      // Il form ora invierà un'email tramite il link mailto
      document.getElementById("reportForm").submit();
    }
  </script>

</body>
</html>
